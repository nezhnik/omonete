# Обновление каталога: монеты и картинки из БД

Деплой **только папки out** (без Node): при сборке данные из БД выгружаются в статические JSON в **public/data/**; каталог и страницы монет читают их из **/data/coins.json** и **/data/coins/[id].json**. Картинки лежат в **public/image/coins/** и попадают в **out/image/coins/**.

Один сценарий: скачать картинки с ЦБ → оптимизировать → записать пути в БД → собрать сайт → залить out на сервер. После этого каталог показывает монеты (из «запечённых» в out данных БД) и наши картинки.

## Шаги (всё делаешь ты один раз по порядку)

### 1. Скачать картинки и обновить БД

В корне проекта (omonete-app), в терминале:

```bash
# Тест: только 5 монет
npm run coins:sync

# Все монеты из БД (долго, пауза между запросами к ЦБ)
npm run coins:sync:all
```

Скрипт:
- берёт из БД монеты с заполненным каталожным номером;
- качает аверс и реверс с cbr.ru;
- оптимизирует (макс. 1200px, WebP quality 88 — почти без потери качества);
- сохраняет в **public/image/coins/**;
- обновляет в БД поля **image_obverse** и **image_reverse** (пути вида `/image/coins/xxx.webp`).

### 2. Собрать сайт

```bash
npm run build
```

В папке **out** окажутся и сайт, и **out/image/coins/** со всеми картинками.

### 3. Залить на сервер

Заливаешь **содержимое папки out** в ISPmanager (как обычно). В корне сайта будет в том числе папка **image/coins/** с картинками.

---

## Когда каталог «обновится»

- **Данные каталога** (список монет, названия, номинал и т.д.) берутся из **БД** через API. Если API у тебя на том же сервере (Node) или на отдельном бэкенде — после обновления БД каталог при следующей загрузке страницы уже показывает новые пути к картинкам.
- **Картинки** отдаются с твоего сайта по путям `/image/coins/...` — они лежат в залитой папке **out/image/coins/**.

Итого: после **coins:sync** (или **coins:sync:all**) → **build** → заливки **out** и (если нужен API) перезапуска приложения — в каталоге будут актуальные монеты из БД и наши оптимизированные картинки.

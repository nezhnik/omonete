# Цены на медь: источники и что попробовать

ЦБ РФ публикует только драгоценные металлы (Au, Ag, Pt, Pd). Меди в их API нет. Ниже — варианты, как получить медь в рублях за грамм и подставить в график.

---

## 1. LME (Лондонская биржа) + курс ЦБ

**Идея:** цена меди на LME в USD за тонну + официальный курс ЦБ USD/RUB → пересчёт в руб/г.

- **LME (London Metal Exchange)** — основной мировой источник котировок меди. Цена обычно в **USD за тонну**.
- **Курс доллара:** бесплатно через ЦБ или зеркало:
  - JSON: `https://www.cbr-xml-daily.ru/daily_json.js` (по текущей дате)
  - По дате: `https://www.cbr-xml-daily.ru/archive/YYYY/MM/DD/daily_json.js`
  - Официально ЦБ: `http://www.cbr.ru/scripts/XML_daily.asp?date_req=DD/MM/YYYY`

**Формула:** `руб/г = (LME_USD_за_тонну / 1_000_000) * USD_RUB`.

**Откуда брать LME по дням (бесплатно с лимитами):**

| Сервис | Что даёт | Регистрация |
|--------|----------|-------------|
| **Commodities-API** (commodities-api.com) | Latest + Historical LME-XCU, JSON | Бесплатный ключ, лимит запросов |
| **Metals-API** (metals-api.com) | Latest, Historical, Time-Series по меди | Бесплатный ключ |

Оба дают цену в USD; конвертацию в рубли делаем сами по курсу ЦБ.

**Что сделать:** зарегистрироваться на одном из сервисов, получить API key, в кроне раз в день запрашивать цену меди (и при необходимости историю за период), курс ЦБ за те же даты, считать руб/г и дополнять данные для графика (например, поле XCU в `metal-prices.json` или отдельная таблица/файл).

---

## 2. Газпромбанк Open API

**Сайт:** https://www.gazprombank.ru/personal/page/openapi/

- Подключение **по заявке** (организация, ИНН, IP), ответ до 3 рабочих дней.
- В описании указаны «курсы валют и металлов»; точный список металлов (есть ли медь) нужно смотреть в инструкции (PDF на странице).
- Если банк отдаёт медь уже в рублях — не нужен отдельный источник курса; если в USD — пересчёт как выше.

**Что сделать:** оставить заявку на подключение, в инструкции проверить наличие меди и формат ответа; при наличии меди в API — использовать в кроне вместо или вместе с LME.

---

## 3. Готовые рублёвые данные (справочно)

- **ntcm.ru** — считают цену меди LME в рублях по курсу ЦБ (страница, не API; парсинг страницы возможен, но хрупкий).
- **kbn.ru** — показывают LME copper и др.; для автоматизации нужен либо API, либо парсинг.

Для стабильной автоматизации надёжнее опираться на API (п. 1 или 2).

---

## Рекомендованный порядок действий

1. **Быстрый старт (LME + ЦБ):**  
   Зарегистрироваться на **Commodities-API** или **Metals-API**, получить ключ. Написать скрипт (Node или PHP), который раз в день:
   - запрашивает цену меди (latest или за вчера);
   - запрашивает курс USD ЦБ за ту же дату;
   - считает руб/г и сохраняет в общий источник данных для графиков (например, расширить `metal-prices.json` полем XCU или добавить столбец в БД и экспорт).

2. **График:**  
   Сейчас медь на фронте — демо (apiSymbol: null). Когда в `metal-prices.json` появится XCU (массивы по периодам, как XAU/XAG), можно дать меди apiSymbol `"XCU"` и читать реальные данные из того же JSON.

3. **Газпромбанк (опционально):**  
   Параллельно подать заявку на Open API; если подключат и в ответах есть медь в рублях — можно переключить источник меди на ГПБ или оставить запасной.

Дальше можно добавить в репозиторий черновой скрипт `scripts/fetch-copper-price.js` (или аналог на PHP для Reg.ru), который по ключу в `.env` дергает один из API и cbr-xml-daily, считает руб/г и пишет результат в файл или БД для использования в графиках.

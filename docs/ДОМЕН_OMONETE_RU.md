# Почему на omonete.ru пусто, а на Vercel всё работает

Если на **xxx.vercel.app** загружаются монеты, дворы и статьи, а на **omonete.ru** — счётчики 0 и иногда сайт не открывается, значит **omonete.ru открывается не с Vercel**, а со старого хостинга (Reg.ru или другого). Там лежит старая версия сайта без API и без доступа к БД.

---

## Что сделать: направить omonete.ru на Vercel

### Где в Vercel посмотреть правильные записи и что вписать в Reg.ru

1. Зайди на **[vercel.com](https://vercel.com)** → войди в аккаунт.
2. Открой проект **omonete** (или как он у тебя называется).
3. Слева или сверху: **Settings** → в меню слева выбери **Domains**.
4. В списке доменов найди **omonete.ru** (и при необходимости **www.omonete.ru**).
5. Нажми на домен **omonete.ru** (или кнопку **Edit** рядом с ним). Откроется блок с подсказкой по DNS.
6. Vercel покажет, **какие записи добавить** у регистратора. Обычно там что-то вроде:
   - **A** — Name: `@`, Value: из таблицы в Vercel (сейчас **216.198.79.1**)
   - для **www** — по подсказке Vercel (CNAME или A)
7. **Скопируй оттуда** тип записи, имя (Name) и значение (Value) — именно их и нужно ввести в Reg.ru.

**В Reg.ru:**  
Рег.ру → **Домены** → **omonete.ru** → **Управление записями** (или «Управление зоной»). Для каждой записи, которую показал Vercel:
- **Имя (хост):** то, что в Vercel в колонке Name (`@` для корня или `www` для www).
- **Тип:** A или CNAME, как в Vercel.
- **Значение:** то, что в Vercel в колонке Value (IP или cname.vercel-dns.com).

Сохрани изменения в Reg.ru. Через 5–15 минут проверь omonete.ru; в Vercel статус домена должен стать **Valid Configuration**.

---

### 1. Проверить, куда сейчас смотрит домен

В терминале (Mac/Linux):

```bash
dig omonete.ru +short
```

Или зайди на [whatsmydns.net](https://www.whatsmydns.net/) и введи `omonete.ru`.

- Если видишь **IP Reg.ru** (например сервер хостинга) или другой старый IP — трафик идёт на старый хостинг.
- Должно быть IP из **Vercel → Settings → Domains** (сейчас Vercel рекомендует **216.198.79.1**).

### 2. Настроить DNS у регистратора (Reg.ru и т.п.)

Зайди в панель управления доменом (Reg.ru → Домены → omonete.ru → Управление записями).

**Всегда смотри актуальные значения в Vercel:** Settings → Domains → нажми на omonete.ru — там таблица «Vercel recommends updating your DNS records». Используй **Type, Name, Value** оттуда.

Сейчас (по расширению IP Vercel) для **корня omonete.ru** обычно:

| Тип  | Имя (хост) | Значение        |
|------|------------|-----------------|
| **A**| `@` или пусто | **216.198.79.1** |

Раньше Vercel давал 76.76.21.21 — оба варианта могут работать, но **приоритет у того, что написано в твоём проекте в Domains**.

Для **www.omonete.ru** — смотри в том же блоке Vercel (CNAME или A и какое значение).

**По скриншоту Reg.ru (управление записями):**

| Имя в таблице   | Что нужно для Vercel (по текущей рекомендации) |
|-----------------|------------------------------------------------|
| `omonete.ru.`   | A → **216.198.79.1** (как в Vercel в таблице «Value») |
| `www.omonete.ru.` | По подсказке Vercel для www (CNAME или A)      |

Записи для ftp, mail, smtp, pop, billing-ping, MX, NS, SOA, TXT не трогай. Меняем только A для корня и для www.

---

## Сломанная вёрстка на omonete.ru (нет стилей, вместо картинок «?»)

Если страница открывается, но без оформления и с квадратиками «?» вместо логотипов/картинок — обычно не подгружаются CSS и картинки.

**Что проверить (ничего в коде не менять, только диагностика):**

1. **Жёсткое обновление и кэш**  
   На https://omonete.ru нажми **Ctrl+Shift+R** (Windows) или **Cmd+Shift+R** (Mac). Либо открой сайт в **режиме инкогнито**. Часто помогает старый кэш HTML (например, с прошлого хостинга).

2. **Вкладка Network в DevTools**  
   F12 → вкладка **Сеть (Network)** → обнови страницу. Посмотри, какие запросы **красные** (ошибка) или с кодом **404**:
   - `/_next/static/css/...` или `/_next/static/chunks/...` — стили и JS Next.js; если 404, вёрстка будет «голая».
   - `/image/logo.png`, `/image/Mints/....webp` — если 404, вместо картинок будет «?».

3. **Если 404 только на omonete.ru, а на omonete.vercel.app всё ок**  
   В Vercel сделай **Redeploy** последнего деплоя (Deployments → три точки у деплоя → Redeploy). После деплоя подожди 1–2 минуты и снова открой omonete.ru в инкогнито — иногда для кастомного домена подтягивается старый кэш, redeploy обновляет раздачу.

4. **В коде**  
   В проекте нет `basePath` и `assetPrefix` — пути к стилям и картинкам относительные (`/image/...`, `/_next/static/...`), они должны работать на любом домене. Менять конфиг не нужно, пока не убедишься по Network, что именно не грузится.

---

## Если снова не загружается omonete.ru, а vercel.app — ок

**Сегодня:** пользуйся и давай ссылку **omonete.vercel.app** — там всё работает.

**Временный обходной путь — редирект в Vercel:**  
Vercel → проект → **Settings** → **Domains** → нажми на **omonete.ru** → **Edit**. Там может быть опция **Redirect to another domain** — укажи **omonete.vercel.app**. Тогда при открытии omonete.ru пользователя перекинет на рабочий сайт. Когда разберёшься с DNS/сетью, редирект можно выключить.

**Вернуть сайт на хостинг Reg.ru (без Vercel):**  
Чтобы omonete.ru снова открывался с серверов Reg.ru, а не с Vercel: (1) Сайт должен быть залит и работать на хостинге Reg.ru (FTP или панель хостинга). (2) В Reg.ru → Домены → omonete.ru → Управление записями поставь для **корня** (omonete.ru / @) запись **A** на **IP твоего хостинга Reg.ru**. Этот IP указан в панели хостинга Reg.ru (часто для общего хостинга это что-то вроде **31.31.196.54** — как у тебя было для www). Для **www** оставь или поставь A на тот же IP. Сохрани. После этого трафик пойдёт на Reg.ru, а не на Vercel. Каталог и API с БД на Reg.ru работать не будут, если там не развёрнуто то же приложение.

---

**Потом, когда будет время:** проверь с другого интернета (мобильный 4G, другой Wi‑Fi), зайди на [whatsmydns.net](https://www.whatsmydns.net) для omonete.ru (сервер в России) — какой A отдаётся. Если 216.198.79.1 и сайт всё равно не открывается — можно написать в поддержку Vercel: нестабильная работа кастомного домена при правильном DNS.

---

## Быстрая проверка: сменить DNS на время

Если сменить DNS только у себя (на компе или телефоне), можно понять, в DNS ли проблема.

**Идея:** твой провайдер может отдавать старый или неправильный IP для omonete.ru. Публичные DNS (Google, Cloudflare) часто быстрее подхватывают правильные записи. Включаешь их на 2–3 минуты, проверяешь omonete.ru, потом возвращаешь как было.

### На Mac (Wi‑Fi)

1. **Системные настройки** → **Сеть** → **Wi‑Fi** → **Подробнее…** (или **Details**).
2. Вкладка **DNS**. Слева список DNS-серверов.
3. Нажми **+** и добавь один из вариантов:
   - **8.8.8.8** (Google)
   - **1.1.1.1** (Cloudflare)
4. Можно временно удалить старые (выделить → минус) и оставить только 8.8.8.8 или 1.1.1.1, либо оставить и старые, и новый — главное, чтобы новый был в списке.
5. **ОК** → **Применить**.
6. Открой в браузере **https://omonete.ru** (лучше в инкогнито). Если сайт открылся — скорее всего дело было в DNS провайдера.
7. Чтобы вернуть как было: в тех же настройках DNS удали 8.8.8.8 / 1.1.1.1 или верни прежние серверы.

### На iPhone (Wi‑Fi)

1. **Настройки** → **Wi‑Fi** → нажми **(i)** у своей сети.
2. Внизу **Настроить DNS** → **Вручную** → **Добавить сервер** → введи **8.8.8.8** или **1.1.1.1** → **Сохранить**.
3. Открой Safari, зайди на **https://omonete.ru**.
4. Потом в том же месте можно переключить обратно на **Авто** (DNS от провайдера).

### Как понять результат

- **После смены DNS omonete.ru открылся** → проблема была в DNS провайдера (кэш или старая запись). Можно оставить 8.8.8.8/1.1.1.1 или подождать, пока у провайдера обновится.
- **После смены DNS всё так же не открывается** → запрос до Vercel не доходит или обрывается по пути (маршрутизация, блокировка, проблема на стороне Vercel для твоего региона). Тогда имеет смысл редирект на vercel.app или обращение в поддержку Vercel.

### 3. В Vercel привязать домен

1. Vercel → твой проект → **Settings** → **Domains**.
2. Добавь **omonete.ru** (и при необходимости **www.omonete.ru**).
3. Vercel покажет, что именно прописать в DNS (сейчас для корня: A → 216.198.79.1).
4. Дождись статуса **Valid** у домена (от нескольких минут до 24–48 часов из‑за DNS).

### 4. После смены DNS

- Обнови страницу omonete.ru (лучше с **жёстким обновлением**: Ctrl+Shift+R или Cmd+Shift+R, или режим инкогнито).
- Каталог, дворы и статьи должны подгружаться так же, как на xxx.vercel.app, потому что запросы пойдут на тот же проект Vercel с тем же API и БД.

---

## Кратко

| Где открываешь   | Куда идёт трафик | Откуда данные        |
|------------------|------------------|------------------------|
| xxx.vercel.app   | Vercel           | API → БД Reg.ru ✅     |
| omonete.ru (сейчас) | Скорее всего старый хостинг | Старый сайт, нет API → 0 монет ❌ |
| omonete.ru (после правок DNS) | Vercel        | API → БД Reg.ru ✅     |

Итог: в DNS для **omonete.ru** должна быть **A-запись с значением из Vercel** (Settings → Domains → omonete.ru; сейчас **216.198.79.1**). Домен добавлен в Vercel. Тогда на omonete.ru будет та же работа, что и на omonete.vercel.app.

---

## Где смотреть логи (сайт не заходит ни с телефона, ни с компьютера)

Правки в коде не делаем — только смотрим логи и настройки.

### 1. Какой IP отдаёт DNS у тебя

Ты делал `ping omonete.ru` и получил **216.198.79.1**. Сейчас Vercel как раз рекомендует A → **216.198.79.1** (расширение IP). Значит, если в Reg.ru для корня уже стоит A = 216.198.79.1 — запись правильная.
- Проверь на [whatsmydns.net](https://www.whatsmydns.net/) для `omonete.ru`: выбери сервер в России и посмотри, какой A отдаётся. Он должен совпадать с тем, что в Vercel → Domains → omonete.ru в колонке Value (сейчас часто **216.198.79.1**).

### 2. Логи в Vercel (открываешь сам в браузере)

Зайди в [vercel.com](https://vercel.com) → проект **omonete** → вкладки:

| Где | Что смотреть |
|-----|----------------|
| **Deployments** | Последний деплой: статус **Ready** (зелёная галочка) или **Error**. Если Error — открыть деплой и смотреть **Build Logs**. |
| **Build Logs** (внутри деплоя) | Ошибки при `npm run build` / `next build`. Если сборка падает — сайт может не открываться. |
| **Settings → Environment Variables** | Есть ли **DATABASE_URL** для Production (и Preview). Без неё API может падать при первом запросе. |
| **Settings → Domains** | Домен **omonete.ru**: статус **Valid Configuration**. Если есть предупреждение — нажать и выполнить то, что просит Vercel (часто правка DNS). |
| **Logs** (или **Functions** / **Runtime Logs**) | В верхнем меню проекта может быть **Logs**. Открыть, отфильтровать по времени, когда ты пытался зайти на omonete.ru. Смотреть запросы к omonete.ru: приходят ли они вообще (status 200/502/504), есть ли ошибки в теле ответа. |

Если в **Logs** запросов с хоста **omonete.ru** нет вообще — трафик до Vercel не доходит (значит, DNS у тебя или у провайдера ведёт на другой IP).

### 3. Что проверить у регистратора (Reg.ru)

- **Домены → omonete.ru → Управление зоной / DNS-серверы**.
- Для хоста **@** (omonete.ru) какая стоит **A-запись**? Она должна совпадать с **Value** из Vercel → Domains → omonete.ru (сейчас Vercel рекомендует **216.198.79.1**). Если не совпадает — заменить на значение из Vercel, сохранить, подождать 10–30 минут и проверить omonete.ru в инкогнито.

### 4. Кратко

- В **коде** проекта нет middleware и нет логики по домену — разницы между omonete.ru и vercel.app в коде нет.
- Снаружи (с сервера) запрос к omonete.ru возвращает страницу и API — значит, с части интернета домен уже смотрит на Vercel.
- Если ни с телефона, ни с компьютера не заходит — проверь, что в Reg.ru A для omonete.ru совпадает с **Value** из Vercel → Domains (сейчас **216.198.79.1**). После смены подожди 10–30 минут и проверь в инкогнито.

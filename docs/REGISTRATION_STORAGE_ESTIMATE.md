# Сколько весят пользователи и портфолио в БД

## Да, это просто записи в БД

- **Регистрация** — одна строка в таблице `users`: id, email, хеш пароля, дата регистрации.
- **Коллекция (портфолио)** — строки в таблице `user_collection`: какой пользователь какую монету добавил (`user_id` + `coin_id`). Данные самой монеты (название, картинка, металл и т.д.) **не дублируются** — они уже есть в каталоге (`/data/coins/[id].json`). При открытии портфолио мы только читаем список `coin_id` у пользователя и подставляем данные из каталога.

---

## Вес одной записи

### Таблица `users` (одна строка = один пользователь)

| Поле           | Примерный размер |
|----------------|------------------|
| id             | 8 байт (bigint) или 16 байт (UUID) |
| email          | ~30–60 байт      |
| password_hash  | ~60 байт (bcrypt) |
| created_at     | 8 байт           |
| **Итого**      | **~120–150 байт на пользователя** |

### Таблица `user_collection` (одна строка = одна монета в коллекции пользователя)

| Поле      | Примерный размер |
|-----------|------------------|
| user_id   | 8 байт (или 16 для UUID) |
| coin_id   | ~10–20 байт (например "4000", "5217-0048-24-ММД") |
| Опционально: quantity, added_at | +10–20 байт |
| **Итого**  | **~40–60 байт на одну монету в коллекции** |

Строка, которую видит пользователь в портфолио (название, картинка, металл, тираж и т.д.), в БД **не хранится** — она собирается из каталога по `coin_id`. То есть «вес одной строки портфолио» в БД — это только одна запись в `user_collection`: **порядка 50 байт**.

---

## Вместимость: сколько людей и портфолио поместятся

При средней коллекции **200 монет** на пользователя:

- 1 пользователь: ~150 байт (users) + 200 × 50 байт (коллекция) ≈ **10 КБ**.
- 1 000 пользователей: ≈ **10 МБ**.
- 10 000 пользователей: ≈ **100 МБ**.
- 50 000 пользователей: ≈ **500 МБ**.

Если в среднем **500 монет** в коллекции:

- 1 пользователь: ~150 + 25 000 ≈ **25 КБ**.
- 10 000 пользователей: ≈ **250 МБ**.
- 20 000 пользователей: ≈ **500 МБ**.

**Supabase Free (500 МБ БД):** при среднем размере коллекции 200–300 монет поместится **порядка 15 000–25 000 пользователей**. При 500 монет в среднем — около **15 000–20 000 пользователей**. Плюс нужно заложить место на индексы и служебные данные (обычно +10–20%), но для оценки этого достаточно.

**Своя MySQL на хостинге:** лимит по диску хостинга. При тех же оценках 10 КБ на пользователя с коллекцией 200 монет: 1 ГБ ≈ 100 000 пользователей.

---

## Кратко

| Что храним в БД | Размер на единицу |
|-----------------|-------------------|
| 1 пользователь (users) | ~150 байт |
| 1 монета в коллекции (user_collection) | ~50 байт |
| Данные монеты (название, картинка и т.д.) | не храним, берём из каталога |

**500 МБ** хватает на **десятки тысяч пользователей** при среднем размере портфолио 200–400 монет.
